--
layout: post
title: "[Recurrent Problems]Josephus Problem"
date: 2018-04-08
tags: Algorithms
---


Remarks:

I wrote this paragraph in my junior year on another blog platform.

<https://www.cnblogs.com/HuisClos/p/8438960.html> 

I move it over here.

Surprisingly, I've read so many things in undergraduate years, but keep on nothing up until now :)

------


$n$ people (numbered  $$ 1 $$  to  $$ n $$ ) around a circle, eliminate every second remaining person until only one survives.

The problem — given the number of people, starting point, direction, and number to be skipped — is to choose the position in the initial circle to avoid execution.

Solution:

In the following,  $$ n $$  denotes the number of people in the initial circle, and  $$ k $$  denotes the count for each step, that is,  $$ k-1 $$  people are skipped and the  $$ k $$  th is executed.

The people in the circle are numbered from  $$ 1 $$  to  $$ n $$ .

We explicitly solve the problem when every second person will be killed, i.e.  $$ k=2 $$ . (For the more general case  $$ k=2 $$ , we outline a solution below.) We express the solution recursively.

Let  $$ f(n) $$  denote the position of the survivor when there are initially  $$ n $$  people (and  $$ k=2 $$ ).

The first time around the circle, all of the $$ even $$  -numbered people die.

The second time around the circle, the new  $$ 2 $$  nd person dies, then the new  $$ 4 $$  th person, etc.;

it's as though there were no first time around the circle.

 
If the initial number of people was  $$ even $$ , then the person in position  $$ x $$  during the second time around the circle was originally in position tetx $$ 2x-1 $$  (for every choice of  $$ x $$ ).

Let tetx $$ n=2j $$ . The person at  $$ f(j) $$  who will now survive was originally in position  $$ 2f(j)-1 $$ .

This gives us the recurrence  $$ f(2j)=2f(j)-1 $$ ;.

If the initial number of people was  $$ odd $$ , then we think of person  $$ 1 $$  as dying at the end of the first time around the circle.

Again, during the second time around the circle, the new  $$ 2 $$  nd person dies, then the new  $$ 4 $$  th person, etc. In this case, the person in position \$$ x $$ was originally in position \$$ 2x+1 $$.

This gives us the recurrence \$$ f(2j+1)=2f(j)+1 $$;.

When we tabulate the values of \$$ n $$ and \$$ f(n) $$ we see a pattern:
\$$ n $$	1	2	3	4	5	6	7	8	9	10	11	12	13	14	15	16
\$$ f(n) $$	1	1	3	1	3	5	7	1	3	5	7	9	11	13	15	1

This suggests that \$$ f(n) $$ is an increasing odd sequence that restarts with \$$ f(n)=1 $$ whenever the index \$$ n $$ is a power of \$$ 2 $$.

Therefore, if we choose \$$ m $$ and \$$ l $$ so that \$$ n=2^{m}+l $$ and \$$ 0\leq l<2^{m} $$, then \$$ f(n)=2\cdot l+1 $$.

It is clear that values in the table satisfy this equation. Or we can think that after \$$ l $$ people are dead there are only \$$ 2^{m} $$ people and we go to the \$$ 2l+1 $$ th person.

He must be the survivor. So \$$ f(n)=2l+1 $$. Below, we give a proof by induction.

Theorem: If \$$ n=2^{m}+l $$ and \$$ 0\leq l<2^{m} $$, then \$$ f(n)=2l+1 $$.

Proof: We use strong induction on \$$ n $$.
      The base case \$$ n=1 $$ is true.
      We consider separately the cases when \$$ n $$ is \$$ even $$ and when \$$ n $$ is \$$ odd $$.
      If \$$ n $$ is \$$ even $$, then choose \$$ l_{1} $$ and \$$ m_{1} $$ such that \$$ n/2=2^{{m_{1}}}+l_{1} $$ and \$$ 0\leq l_{1}<2^{{m_{1}}} $$. Note that \$$ l_{1}=l/2 $$.
      We have \$$ f(n)=2f(n/2)-1=2((2l_{1})+1)-1=2l+1 $$, where the second equality follows from the induction hypothesis.
      If \$$ n $$ is \$$ odd $$, then choose \$$ l_{1} $$ and \$$ m_{1} $$ such that \$$ (n-1)/2=2^{{m_{1}}}+l_{1} $$ and \$$ 0\leq l_{1}<2^{{m_{1}}} $$. Note that \$$ l_{1}=(l-1)/2 $$.
      We have \$$ f(n)=2f((n-1)/2)+1=2((2l_{1})+1)+1=2l+1 $$, where the second equality follows from the induction hypothesis.
      This completes the proof.
      We can solve for $l$ to get an explicit expression for \$$ f(n) $$:
      \$$ f(n)=2(n-2^{{\left\lfloor \log _{2}(n)\right\rfloor }} )+1 $$